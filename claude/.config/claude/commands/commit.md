# Claude Command: Commit

このコマンドは、適切なフォーマットのコミットメッセージを作成し、実際にコミットを実行します。

## 使用方法

コミットを作成するには:
```
/commit
```

オプション付きで実行:
```
/commit --no-verify
```

## コマンドの動作

1. `--no-verify`を指定しない限り、自動的にプリコミットチェックを実行:
    - `pnpm lint` でコード品質を確認
    - `pnpm test` でテストが通ることを確認（存在する場合）
2. `git status`でステージされたファイルを確認
3. ステージされたファイルが0の場合、`git add -A`で全ての変更を自動的に追加
4. `git diff --staged`で変更内容を理解
5. 差分を分析し、複数の論理的な変更が含まれているか判断
6. 複数の変更がある場合、複数のコミットに分割することを提案
7. 各コミット（または単一コミット）に対して、絵文字付きコミットメッセージを作成
8. 実際に`git commit`を実行

## コマンドオプション

- `--no-verify`: プリコミットチェック（lint、test）をスキップ

## 重要な注意事項

- デフォルトでプリコミットチェックが実行され、コード品質を保証
- チェックが失敗した場合、修正してから再実行するか確認を求める
- 特定のファイルがすでにステージされている場合、それらのファイルのみコミット
- ファイルがステージされていない場合、全ての変更を自動的にステージ
- コミットメッセージは検出された変更に基づいて構築
- コミット前に差分をレビューし、複数のコミットが適切かを判断
- 必要に応じて変更を個別にステージしてコミットをサポート

## 📝 コミットメッセージ生成ルール

以下のルールに従って、日本語のコミットメッセージを生成してください。

### 基本ルール

- **メッセージは日本語で書いてください。**
- **コミットメッセージの先頭に、変更の種類に応じた絵文字とプレフィックス（分類）を必ず付けてください。**
- **主語は「変更されたコンポーネントや機能」を意識してください。**
- **1行目で変更内容を要約してください（サマリー行）。**
- **絵文字とプレフィックスは、サマリー行にのみ付けてください。**
- **詳細な説明が必要な場合は、空行を挟んで2行目以降に記述してください。**
- **詳細説明では箇条書きや複数行の説明を許可しますが、冗長な説明は避けてください。**

### 絵文字とプレフィックス一覧（変更種別）

| 絵文字 | プレフィックス | 内容 | 例 |
|--------|----------------|------|-----|
| :+1:   | feat           | **機能・要素の追加、新しい振る舞い、改善** | :+1: feat: ユーザー登録ページを追加 |
| :bug:  | fix            | バグ修正、不具合対応 | :bug: fix: ログイン時に発生するバリデーションエラーを修正 |
| :books:| docs           | ドキュメントの追加・修正 | :books: docs: API仕様の記述をREADMEに追加 |
| :sparkles: | style      | スタイルやフォーマットの調整（動作に影響しない） | :sparkles: style: コード整形と不要な空行を削除 |
| :hammer: | refactor     | **既存機能を変更せず内部構造のみ改善** | :hammer: refactor: 重複コードを共通関数に抽出 |
| :rocket: | perf         | パフォーマンス改善 | :rocket: perf: リスト表示のレンダリング速度を向上 |
| :test_tube: | test      | テストの追加・修正 | :test_tube: test: バリデーションユーティリティのテストを追加 |
| :construction_worker: | build | ビルド構成・依存関係の調整 | :construction_worker: build: webpackの設定を変更 |
| :robot: | ci            | CI/CD構成の変更 | :robot: ci: CircleCIのジョブを修正 |
| :wrench: | chore        | 雑務的な作業（設定・依存更新など） | :wrench: chore: TypeScriptのバージョンを更新 |
| :rewind: | revert       | 以前のコミットを元に戻す | :rewind: revert: 不具合のあったレイアウト変更を取り消し |

### 判断基準の明確化

**feat（機能追加）に該当するケース：**
- 新しいコンポーネント・関数・クラスの追加
- 既存UIに新しいボタン・フィールド・機能を追加
- 新しいAPI呼び出しやデータ取得機能
- ユーザーが直接体験する新しい動作・操作
- 新しいバリデーション・計算ロジック
- 新しい表示項目やレイアウト要素
- エラーハンドリングの追加・向上

**refactor（リファクタリング）に該当するケース：**
- 既存機能の動作を変えず、コード構造のみ改善
- 重複コードの共通化
- 変数名・関数名の変更（動作変更なし）
- ファイル分割・統合（機能変更なし）

### 判断に迷うケースの例

| 変更内容 | 分類 | 理由 |
|----------|------|------|
| 新しいボタンを追加 | :+1: feat | ユーザーが体験する新機能 |
| 既存ボタンのスタイル変更 | :+1: feat | 見た目の改善もユーザー価値 |
| フォームにバリデーション追加 | :+1: feat | 新しいユーザー体験 |
| useState → useReducer変更 | :hammer: refactor | 動作変更なし、内部実装のみ |
| エラーメッセージを追加 | :+1: feat | ユーザー体験の向上 |
| console.log削除 | :sparkles: style | コード整理 |
| 型定義を追加 | :+1: feat | 開発体験の向上 |
| APIレスポンス形式変更対応 | :+1: feat | 新しいデータ対応 |

### 書き方の指針

**サマリー行（1行目）の指針：**
- **50文字以内で記述してください。**
- **変更は「コンポーネント単位」または「機能単位」で記述してください。**
    - ✅ OK: 「ユーザーカード表示機能を追加」
    - ❌ NG: 「ユーザーカードコンポーネントのレイアウトを修正し、表示ロジックを改善して使いやすさを向上」
- **動詞は最後に配置してください。**
    - ✅ OK: 「翻訳機能を追加」
    - ❌ NG: 「追加した翻訳機能」
- **曖昧な言葉（例：とりあえず、ちょっと、いくつか）は禁止です。**

**詳細説明（2行目以降）の指針：**
- **複数の変更点がある場合は箇条書きで記述可能です。**
- **変更の背景や理由を簡潔に説明できます。**
- **1つの変更点につき1行程度を目安とし、冗長な説明は避けてください。**

### 運用例

#### 良い例（推奨）
```text
:+1: feat: 翻訳機能を追加
:bug: fix: ログインエラーを修正
:hammer: refactor: 共通関数を抽出
:sparkles: style: コードを整形
```

#### 悪い例（冗長・複雑）
```text
❌ :+1: feat: カスタムメッセージの翻訳機能と元に戻す機能を実装し、ユーザー体験を向上
❌ :bug: fix: ユーザーがログインする際に発生していたバリデーションエラーの問題を解決
❌ :hammer: refactor: コードの可読性を向上させるために共通関数に抽出し、重複を削除
```

## コミット分割のガイドライン

差分を分析する際、以下の基準でコミットを分割することを検討：

1. **異なる関心事**: コードベースの無関係な部分への変更
2. **異なる変更タイプ**: 機能追加、バグ修正、リファクタリングなどの混在
3. **ファイルパターン**: 異なるタイプのファイルへの変更（例：ソースコード vs ドキュメント）
4. **論理的なグループ**: 個別に理解・レビューしやすい変更
5. **サイズ**: 非常に大きな変更を分割してより明確に

### 良いコミット分割の例:
- 1つ目: :+1: feat: 新しいsolcバージョンの型定義を追加
- 2つ目: :books: docs: 新しいsolcバージョンのドキュメントを更新
- 3つ目: :wrench: chore: package.jsonの依存関係を更新
- 4つ目: :test_tube: test: 新しいsolcバージョン機能のユニットテストを追加

## 🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>