# エージェントオーケストレーション

## 概要

Claude Codeのエージェントシステムは、特定のタスクに特化した処理を行います。`~/.claude/agents/` に9つのエージェントが用意されており、開発の各フェーズで活用できます。

## エージェント一覧

| エージェント | 用途 |
|--------------|------|
| `planner` | 複雑な機能の実装計画 |
| `architect` | システム設計・アーキテクチャ決定 |
| `tdd-guide` | テスト駆動開発のガイダンス |
| `code-reviewer` | コード品質・セキュリティ監査 |
| `security-reviewer` | セキュリティ脆弱性の詳細分析 |
| `build-error-resolver` | ビルド・型エラーの解決 |
| `e2e-runner` | エンドツーエンドテスト |
| `refactor-cleaner` | リファクタリング・不要コード削除 |
| `doc-updater` | ドキュメント・コードマップ更新 |

## 自動起動ガイドライン

コンテキストに基づいてエージェントを自動的に起動する：

| 状況 | 使用エージェント |
|------|------------------|
| 複雑な機能の実装依頼 | `planner` |
| コード変更後 | `code-reviewer` |
| 新規実装時 | `tdd-guide` |
| 設計上の考慮が必要 | `architect` |
| セキュリティ懸念がある | `security-reviewer` |
| ビルドエラー発生 | `build-error-resolver` |
| UIフロー検証 | `e2e-runner` |
| コード整理 | `refactor-cleaner` |
| ドキュメント更新 | `doc-updater` |

## 実行戦略

### 並列実行を活用

**独立した操作には常に並列Taskを使用する**

```
✅ 良い例: 同時実行
- セキュリティ分析
- パフォーマンスレビュー
- 型チェック

❌ 悪い例: 順次実行
1. セキュリティ分析 → 待機
2. パフォーマンスレビュー → 待機
3. 型チェック
```

## 高度な分析アプローチ

複雑な課題に対しては、複数の専門サブエージェントを同時に展開：

### マルチパースペクティブ分析

```
┌─────────────────────────────────────────┐
│           複雑な問題                      │
└─────────────────┬───────────────────────┘
                  │
    ┌─────────────┼─────────────┐
    │             │             │
    ▼             ▼             ▼
┌───────┐   ┌───────┐   ┌───────┐
│ 事実   │   │シニア │   │セキュ │
│チェック│   │エンジ │   │リティ │
└───────┘   └───────┘   └───────┘
    │             │             │
    ▼             ▼             ▼
┌───────┐   ┌───────┐
│一貫性 │   │冗長性 │
│チェック│   │チェック│
└───────┘   └───────┘
```

### 専門家の視点

1. **事実チェッカー**: 情報の正確性を検証
2. **シニアエンジニア**: 技術的妥当性を評価
3. **セキュリティエキスパート**: 脆弱性を特定
4. **一貫性レビュアー**: コードスタイルの統一性を確認
5. **冗長性チェッカー**: 重複・不要コードを検出

## ワークフロー例

### 新機能開発

```
1. planner        → 実装計画を作成
2. architect      → 設計をレビュー
3. tdd-guide      → テストを先に書く
4. code-reviewer  → 実装をレビュー
5. security-reviewer → セキュリティ確認
```

### バグ修正

```
1. build-error-resolver → エラー解決
2. code-reviewer        → 修正をレビュー
3. e2e-runner          → 回帰テスト
```

### リファクタリング

```
1. refactor-cleaner → 不要コード特定・削除
2. code-reviewer    → 変更をレビュー
3. doc-updater      → ドキュメント更新
```
